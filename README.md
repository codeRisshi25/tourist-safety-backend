# Tourist Safety Backend

## Overview

This project is the backend for the "Smart Tourist Safety Monitoring & Incident Response System". It provides a secure and scalable foundation for managing tourists, authorities, IoT devices, and health data. The system is built with Node.js, Express, and Sequelize, and it connects to a PostgreSQL database.

## Features

- **Authentication**: Secure user registration and login for both tourists and authorities using JWT (JSON Web Tokens).
- **User Management**: CRUD operations for managing tourist and authority data.
- **Device Management**: API endpoints for registering and managing IoT devices.
- **Health Monitoring**: Real-time tracking of tourist health vitals.
- **Blockchain Integration**: Securely store and verify tourist identities using a blockchain.

## Project Structure

```
.
├── app.js
├── package.json
├── config/
│   └── database.js
├── controllers/
│   ├── authController.js
│   └── exampleController.js
├── migrations/
│   ├── ...
├── models/
│   ├── authority.js
│   ├── blockchainId.js
│   ├── healthVital.js
│   ├── index.js
│   ├── iotDevice.js
│   └── tourist.js
├── routes/
│   ├── authRoutes.js
│   └── index.js
└── .env
```

- **`app.js`**: The main entry point of the application.
- **`config/`**: Contains the database configuration.
- **`controllers/`**: Handles the business logic for each route.
- **`migrations/`**: Database migration files generated by Sequelize.
- **`models/`**: Sequelize models for the database tables.
- **`routes/`**: Defines the API routes.
- **`.env`**: Environment variables for the application.

## API Routes

### Authentication

- **`POST /api/auth/register`**: Register a new tourist or authority.
- **`POST /api/auth/login`**: Log in a user and receive a JWT.
- **`GET /api/auth/profile`**: Get the profile of the currently logged-in user.

### Data Flow

1. **Registration**: A new user (tourist or authority) sends a `POST` request to `/api/auth/register` with their details.
2. **Login**: The user sends a `POST` request to `/api/auth/login` with their credentials. The server responds with a JWT.
3. **Authenticated Requests**: For protected routes, the user includes the JWT in the `Authorization` header of their request.
4. **Profile**: A `GET` request to `/api/auth/profile` retrieves the user's profile information.

## Getting Started

### Prerequisites

- Node.js
- npm
- PostgreSQL

### Installation

1. Clone the repository:
   ```bash
   git clone https://github.com/codeRisshi25/tourist-safety-backend.git
   ```
2. Install the dependencies:
   ```bash
   npm install
   ```
3. Create a `.env` file and add the following environment variables:
   ```
   PORT=3000
   DB_USER=your_db_user
   DB_PASSWORD=your_db_password
   DB_NAME=your_db_name
   DB_HOST=your_db_host
   DB_PORT=your_db_port
   ACCESS_TOKEN_SECRET=your_access_token_secret
   REFRESH_TOKEN_SECRET=your_refresh_token_secret
   ```
4. Run the database migrations:
   ```bash
   npx sequelize-cli db:migrate
   ```
5. Start the server:
   ```bash
   npm start
   ```

The server will be running at `http://localhost:3000`.
